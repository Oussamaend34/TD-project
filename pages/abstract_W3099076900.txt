Mammography is currently the most powerful technique for early detection of breast cancer. To assist radiologists to better interpret mammogram images, computer-aided detection and diagnosis (CAD) systems have been proposed. This paper proposes a complete CAD system for mass detection and diagnosis, which consists of four steps. The first step consists of the preprocessing where the image is enhanced and the noise removed. In the second step, the abnormalities are segmented using the proposed HRAK algorithm. In the third step, the false positives are reduced using texture and shape features and the bagged trees classifier. Finally, the support vector machine (SVM) is used to classify the abnormalities as malignant or benign. The proposed CAD system is verified with both the MIAS and CBIS-DDSM databases. The experimental results proved to be successful. The accuracy detection rate achieves 93,15% for sensitivity and 0,467 FPPI for MIAS and 90,85% for sensitivity and 0,65 FPPI for CBIS-DDSM. The accuracy classification rate achieves 94,2% and the AUC 0,95 for MIAS and 90,44% and 0,9 for CBIS-DDSM.